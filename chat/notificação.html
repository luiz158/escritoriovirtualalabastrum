
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<style>
div.notificacao{
box-shadow: 5px 5px 5px #888;
border-radius: 5px;
background-color: orange;
color: white;
height: 60px;
width: 79px;
right: -100px;
position: fixed;
top: 25%;
padding-left: 20px;
cursor: pointer;
}

#divchat{
display: none;
bottom: 0px;
position: fixed;
right: 0px;
}

#iframechat{
border: 0px;
width: 1000px;
height: 250px;
}

</style>

<div class='notificacao' > teste </div>

<form id="formescritoriovirtualalabastrum" method="post" action="http://localhost:8080/escritoriovirtualalabastrum/login/loginVindoDoPCP" target="novaAbaescritoriovirtualalabastrum" style="display: none" >
	<input type="hidden" id='loginescritoriovirtualalabastrum' name="loginescritoriovirtualalabastrum" value="renan" />
	<input type="hidden" id='senhaescritoriovirtualalabastrum' name="senhaescritoriovirtualalabastrum" value="1234" />
	<input type="hidden" id="nomeescritoriovirtualalabastrum" name="nomeescritoriovirtualalabastrum" value="Renan Vaz" />
	<input type="hidden" id="nomeEmpresaescritoriovirtualalabastrum" name="nomeEmpresaescritoriovirtualalabastrum" value="Projetec" />
	<input type="hidden" id="enderecoescritoriovirtualalabastrum" name="enderecoescritoriovirtualalabastrum" value="http://localhost:8080/escritoriovirtualalabastrum" />
</form>


<script type="text/javascript">

    jQuery(document).ready(function(){
    	
    	if(navigator.appName != 'Microsoft Internet Explorer'){
    	
    		loginescritoriovirtualalabastrum = jQuery("#loginescritoriovirtualalabastrum").val();
    		senhaescritoriovirtualalabastrum = jQuery("#senhaescritoriovirtualalabastrum").val();
    		nomeescritoriovirtualalabastrum = jQuery("#nomeescritoriovirtualalabastrum").val();
    		nomeEmpresaescritoriovirtualalabastrum = jQuery("#nomeEmpresaescritoriovirtualalabastrum").val();
    		enderecoescritoriovirtualalabastrum = jQuery("#enderecoescritoriovirtualalabastrum").val();
	
			setTimeout(verificaExistenciaNovasMensagensSemDevolverJsonComMensagens, 2000);
			setInterval(verificaExistenciaNovasMensagensSemDevolverJsonComMensagens, 60000);
	    }
    	
    	jQuery(".notificacao").click(function() {
    		
    		jQuery("div.notificacao").animate({right:-100,}, 500);
    		
			var formescritoriovirtualalabastrum = document.getElementById('formescritoriovirtualalabastrum');
			window.open('', 'novaAbaescritoriovirtualalabastrum');
			formescritoriovirtualalabastrum.submit();
    	});
    	
    });
    
    function verificaExistenciaNovasMensagensSemDevolverJsonComMensagens(){
    	
    	jQuery.ajax({ 
	        type: 'GET',
	        url: enderecoescritoriovirtualalabastrum + "/chat/verificaExistenciaNovasMensagensSemDevolverJsonComMensagens?loginescritoriovirtualalabastrum=" + loginescritoriovirtualalabastrum + "&senhaescritoriovirtualalabastrum="+ senhaescritoriovirtualalabastrum + "&nomeescritoriovirtualalabastrum="+ nomeescritoriovirtualalabastrum + "&nomeEmpresaescritoriovirtualalabastrum="+ nomeEmpresaescritoriovirtualalabastrum  ,
	        dataType: 'jsonp', 
	        jsonp: false,
			jsonpCallback: "jsonVerificacaoExistenciaNovasMensagensSemDevolverJsonComMensagens",
	        success: function(data) { 
	        	
	        	if(data.boolean){
	        		
	        		exibirNotificacaoNovaMensagem();	        		
	        	}	        	
	        }
		});
    }
    
    function exibirNotificacaoNovaMensagem(){

    	jQuery("div.notificacao").animate({right:0,}, 500);
    }
    
</script>